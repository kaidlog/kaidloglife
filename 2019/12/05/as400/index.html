<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>How to use as400 to automize the data stream? | KaidlogLife</title><meta name="keywords" content="as400"><meta name="author" content="Cheng Kai(Nicholas) Cheng"><meta name="copyright" content="Cheng Kai(Nicholas) Cheng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="資料格式1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011">
<meta property="og:type" content="article">
<meta property="og:title" content="How to use as400 to automize the data stream?">
<meta property="og:url" content="https://kaidloglife.netlify.app/2019/12/05/as400/index.html">
<meta property="og:site_name" content="KaidlogLife">
<meta property="og:description" content="資料格式1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.itl.cat/pngfile/big/287-2878120_desktop-high-res-hd-wallpapers-38120428-desktop-wallpaper.jpg">
<meta property="article:published_time" content="2019-12-05T14:51:24.000Z">
<meta property="article:modified_time" content="2022-05-18T17:38:36.124Z">
<meta property="article:author" content="Cheng Kai(Nicholas) Cheng">
<meta property="article:tag" content="as400">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.itl.cat/pngfile/big/287-2878120_desktop-high-res-hd-wallpapers-38120428-desktop-wallpaper.jpg"><link rel="shortcut icon" href="https://i.imgur.com/9bsJBDO.png"><link rel="canonical" href="https://kaidloglife.netlify.app/2019/12/05/as400/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'How to use as400 to automize the data stream?',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-19 01:38:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="KaidlogLife" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.imgur.com/MMQsfsJ.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.itl.cat/pngfile/big/287-2878120_desktop-high-res-hd-wallpapers-38120428-desktop-wallpaper.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">KaidlogLife</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">How to use as400 to automize the data stream?</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2019-12-05T14:51:24.000Z" title="Created 2019-12-05 22:51:24">2019-12-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-05-18T17:38:36.124Z" title="Updated 2022-05-19 01:38:36">2022-05-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Software-Development/">Software Development</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Software-Development/as400/">as400</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="資料格式"><a href="#資料格式" class="headerlink" title="資料格式"></a>資料格式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line">F*+==============================================================+</span><br><span class="line">H DEBUG DATEDIT(*YMD) DATFMT(*YMD)                                </span><br><span class="line">H OPTION(*SRCSTMT:*NODEBUGIO)                                     </span><br><span class="line">F*===============================================================+</span><br><span class="line">FCPWFTR    IF   E             DISK    USROPN INFDS(FDS0)          </span><br><span class="line">FCPWFTR1   IF   E             DISK    USROPN INFDS(FDS1)          </span><br><span class="line">FCPWFTR2   IF   E             DISK    USROPN INFDS(FDS2)          </span><br><span class="line">FCPWFTR3   IF   E             DISK    USROPN INFDS(FDS3)          </span><br><span class="line">FCPWFTR4   IF   E             DISK    USROPN INFDS(FDS4)          </span><br><span class="line">FCPWFTR5   IF   E             DISK    USROPN INFDS(FDS5)          </span><br><span class="line">FCPWFTR6   IF   E             DISK    USROPN INFDS(FDS6)          </span><br><span class="line">FCPWFTR7   IF   E             DISK    USROPN INFDS(FDS7)           </span><br><span class="line">FCPWFTR8   IF   E             DISK    USROPN INFDS(FDS8)           </span><br><span class="line">FCPWFTS1   O    E             DISK    USROPN                       </span><br><span class="line">FCPWFTS2   O    E             DISK    USROPN                       </span><br><span class="line">FCPWFTS3   O    E             DISK    USROPN                       </span><br><span class="line">FCPWFTS4   O    E             DISK    USROPN                       </span><br><span class="line">FCPWFTS5   O    E             DISK    USROPN                       </span><br><span class="line">FCPWFTS6   O    E             DISK    USROPN                       </span><br><span class="line">FCPWFTS7   O    E             DISK    USROPN                       </span><br><span class="line">FCPWFTS8   O    E             DISK    USROPN                       </span><br><span class="line">FCLMPID01  IF   E           K DISK                                 </span><br><span class="line">FCPMDM1    IF   E           K DISK                                 </span><br><span class="line">FCPMDM2    IF   E           K DISK                                 </span><br><span class="line">FCLMDM201  IF   E           K DISK    RENAME(MDM2R:MDM2R01)        </span><br><span class="line">FCPTFTB    UF A E           K DISK                                 </span><br><span class="line">D*===============================================================* </span><br><span class="line">D                SDS                                               </span><br><span class="line">D MSGQ              *PROC                                          </span><br><span class="line">D  USRID                254    263                                 </span><br><span class="line">D  USRID1               254    259                                 </span><br><span class="line">D*===============================================================* </span><br><span class="line">D                UDS                                               </span><br><span class="line">D  #WSID                170    179                                 </span><br><span class="line">D* 定義資料筆數參數 =============================================* </span><br><span class="line">D FDS0            DS                                               </span><br><span class="line">D  RCDNO0               156    159B 0                              </span><br><span class="line">D FDS1            DS                                               </span><br><span class="line">D  RCDNO1               156    159B 0                              </span><br><span class="line">D FDS2            DS                                               </span><br><span class="line">D  RCDNO2               156    159B 0                              </span><br><span class="line">D FDS3            DS                                               </span><br><span class="line">D  RCDNO3               156    159B 0                              </span><br><span class="line">D FDS4            DS                                               </span><br><span class="line">D  RCDNO4               156    159B 0                              </span><br><span class="line">D FDS5            DS                                                </span><br><span class="line">D  RCDNO5               156    159B 0                               </span><br><span class="line">D FDS6            DS                                                </span><br><span class="line">D  RCDNO6               156    159B 0                               </span><br><span class="line">D FDS7            DS                                                </span><br><span class="line">D  RCDNO7               156    159B 0                               </span><br><span class="line">D FDS8            DS                                                </span><br><span class="line">D  RCDNO8               156    159B 0                               </span><br><span class="line">D* DATAQ LAYOUT =================================================*  </span><br><span class="line">D #PSND2          DS                                                </span><br><span class="line"> * 通知處理碼                                                       </span><br><span class="line">D  @NPCOD                 1      2                                  </span><br><span class="line"> * 來源主機                                                         </span><br><span class="line">D  @HOSFR                 3     12                                  </span><br><span class="line"> * 來源 LIBRARY                                                     </span><br><span class="line">D  @LIB                  13     22                                  </span><br><span class="line"> * 來源  FILE NAME : CPWFTS#                                        </span><br><span class="line">D  @FILNM                23     32                                   </span><br><span class="line"> * 來源 MEMBER :  產生的 OUTPUT MEMBER                               </span><br><span class="line">D  @MBRNM                33     42                                   </span><br><span class="line"> * 目的主機 : 固定為 INDM                                            </span><br><span class="line">D  @HOSTO                43     52                                   </span><br><span class="line"> * 特店代碼                                                          </span><br><span class="line">D  @MCHNO                53     67                                   </span><br><span class="line"> * 目的檔案名稱                                                      </span><br><span class="line">D  @FILTX                68     87                                   </span><br><span class="line"> * 目的 PC 名稱                                                      </span><br><span class="line">D  @PCFNM                68     82                                   </span><br><span class="line"> * 廠商代碼                                                          </span><br><span class="line">D  @MOCNO                68     71                                   </span><br><span class="line"> * 檔案類別                                                          </span><br><span class="line">D  @FILTP                72     72                                   </span><br><span class="line"> * 批號 (10A):YYYYMMDD + NN, NN: 序號 &#x27;00&#x27;-&#x27;99&#x27;                      </span><br><span class="line">D  @DATE                 73     80  0                                </span><br><span class="line">D  @SEQ                  81     82  0                      </span><br><span class="line"> * 傳送方式  (1A): I-  銀行端接收檔  , O-  銀行端回覆檔    </span><br><span class="line">D  @SNDTP                83     83                         </span><br><span class="line"> * 副檔名                                                  </span><br><span class="line">D  @SNDTX                84     87                         </span><br><span class="line"> * TN5250 參數，留空白會用預設值                           </span><br><span class="line">D  @DEFUL                88     97                         </span><br><span class="line"> * 檔案種類 0-5                                            </span><br><span class="line">D  @DEF1                 88     88                         </span><br><span class="line"> * 中文內碼：預設為 BIG-5                                  </span><br><span class="line">D  @DEF2                 89     89                         </span><br><span class="line"> * 跳行指令：預設為 CR+LF                                  </span><br><span class="line">D  @DEF3                 90     90                         </span><br><span class="line"> * 輸出：預設為檔案輸出                                    </span><br><span class="line">D  @DEF4                 91     91                         </span><br><span class="line"> * 檔案結尾加 0E0F ：預設不勾選                            </span><br><span class="line">D  @DEF5                 92     92                         </span><br><span class="line"> * 0E/0F 轉為空白：預設勾選，表示不會位移                          </span><br><span class="line">D  @DEF6                 93     93                                 </span><br><span class="line"> * 中文空白以英文空白取代：預設不勾選                              </span><br><span class="line">D  @DEF7                 94     94                                 </span><br><span class="line"> * 檔案欄位加 TAB 分隔字元：預設不勾選                             </span><br><span class="line">D  @DEF8                 95     95                                 </span><br><span class="line"> * EXCEL OUTPUT WITH HEADER ：預設不勾選                           </span><br><span class="line">D  @DEF9                 96     96                                 </span><br><span class="line"> * UNICODE ：預設不勾選                                            </span><br><span class="line">D  @DEF10                97     97                                 </span><br><span class="line"> * 是否壓縮旗標 (1 位 ) ，可輸入 Y/N ，預設 Y( 壓縮 )              </span><br><span class="line">D  @DEF11                98     98                                 </span><br><span class="line"> * 密碼 (12 位 ) ，若壓縮旗標為 N ，本欄位自動設成無密碼           </span><br><span class="line">D  @DEF12                99    110                                 </span><br><span class="line">D  @FTPDE              1024   1024                                 </span><br><span class="line">D* 定義常數 =====================================================* </span><br><span class="line"> * 下傳通知 DTAQ                                                   </span><br><span class="line">D #SDQN2          C                   CONST(&#x27;FTPBKS00A&#x27;)           </span><br><span class="line">D #HEAD           C                   CONST(&#x27;CUSTOMER_ID&#x27;)         </span><br><span class="line">D*===============================================================* </span><br><span class="line">D                 DS                                               </span><br><span class="line">D #TIM14                        14  0                              </span><br><span class="line">D  #TIME6                        6  0 OVERLAY(#TIM14:01)           </span><br><span class="line">D  #DATE8                        8  0 OVERLAY(#TIM14:07)           </span><br><span class="line">D*===============================================================* </span><br><span class="line">D                 DS                                               </span><br><span class="line">D #STEXT                  1     65                                 </span><br><span class="line"> * 資料日期                                                        </span><br><span class="line">D #DTADT                  1      8  0                              </span><br><span class="line"> * 分隔符號                                                        </span><br><span class="line">D #X1                     9      9    INZ(&#x27;,&#x27;)                     </span><br><span class="line"> * 文字限定詞                                                      </span><br><span class="line">D #D1                    10     10    INZ(&#x27;&quot;&#x27;)                     </span><br><span class="line"> * 卡號 ( 亂碼 )                                                   </span><br><span class="line">D #CNOHS                 11     42                                  </span><br><span class="line"> * 文字限定詞                                                       </span><br><span class="line">D #D2                    43     43    INZ(&#x27;&quot;&#x27;)                      </span><br><span class="line"> * 分隔符號                                                         </span><br><span class="line">D #X2                    44     44    INZ(&#x27;,&#x27;)                      </span><br><span class="line"> * 文字限定詞                                                       </span><br><span class="line">D #D3                    45     45    INZ(&#x27;&quot;&#x27;)                      </span><br><span class="line"> * 卡號  亂碼 )                                                     </span><br><span class="line">D #CANOF                 46     64                                  </span><br><span class="line"> * 文字限定詞                                                       </span><br><span class="line">D #D4                    65     65    INZ(&#x27;&quot;&#x27;)                      </span><br><span class="line">D*===============================================================*  </span><br><span class="line">D                 DS                                                </span><br><span class="line">D #OLDID                  1     19                                  </span><br><span class="line">D  #ID08                  1      8                                  </span><br><span class="line">D  #ID09                  1      9                                  </span><br><span class="line">D  #ID9                   9      9                                  </span><br><span class="line">D  #ID10                 10     10                                  </span><br><span class="line">D  #ID11                  1     11                                  </span><br><span class="line">D*===============================================================*  </span><br><span class="line">D                 DS                                                </span><br><span class="line">D #DATE                   1      8  0 INZ(0)                        </span><br><span class="line">D  #DATES                 1      8                                  </span><br><span class="line">D* 預設值 =======================================================*  </span><br><span class="line">D #FILTP          S              1A   INZ(*BLANK)                   </span><br><span class="line">D #MOCNO          S              4A   INZ(*BLANK)                   </span><br><span class="line">D #POS            S              2S 0 INZ(0)                        </span><br><span class="line">D #IDST           S              2S 0 INZ(0)                        </span><br><span class="line">D #IDED           S              2S 0 INZ(0)                        </span><br><span class="line">D #IDLEN          S              2S 0 INZ(0)                        </span><br><span class="line">D #INT            S              1S 0 INZ(0)                        </span><br><span class="line">D #NEWID          S             10A   INZ(*BLANK)                   </span><br><span class="line">D @NEWID          S             40A   INZ(*BLANK)                   </span><br><span class="line">D #TYPE           S              1A   INZ(*BLANK)                   </span><br><span class="line">D #RTEXT          S           4090A   INZ(*BLANK)                  </span><br><span class="line">D #DATE7          S              7S 0 INZ(0)                       </span><br><span class="line">D #TIME           S              6S 0 INZ(0)                       </span><br><span class="line"> *                                                                 </span><br><span class="line">D #LIB            S              5A   INZ(*BLANK)                  </span><br><span class="line">D #SFILE          S             10A   INZ(*BLANK)                  </span><br><span class="line">D #BATSQ          S              2S 0 INZ(0)                       </span><br><span class="line">D #DQNAM          S             10A   INZ(*BLANK)                  </span><br><span class="line">D #DQLIB          S             10A   INZ(*BLANK)                  </span><br><span class="line">D #DQLEN          S              5P 0 INZ(0)                       </span><br><span class="line"> * 從 C912V0C 傳來的參數 1=====================================*   </span><br><span class="line">D #PACK           DS                                               </span><br><span class="line"> * ＰＣ檔名 (16)                                                   </span><br><span class="line">D  #RPCFNM               11     26                                 </span><br><span class="line"> *   CPTFTB 檔案類別 (1)                                           </span><br><span class="line">D    #RFILTP             15     15                                 </span><br><span class="line"> *   CPTFTB 廠商代碼 (4)                                           </span><br><span class="line">D    #RMOCNO             11     14                                </span><br><span class="line"> *   CPTFTB 批號日期 (8)                                          </span><br><span class="line">D    #RBATNO             16     23  0                             </span><br><span class="line"> *   CPTFTB 批號序號 (2)                                          </span><br><span class="line">D    #RBATSQ             24     25  0                             </span><br><span class="line"> * 來源檔案 (10)                                                  </span><br><span class="line">D  #RFILE                27     36                                </span><br><span class="line"> * 從 C912V0C 傳來的參數 2=====================================*  </span><br><span class="line">D #C912V          DS                                              </span><br><span class="line"> * ＰＣ檔名 (15)                                                  </span><br><span class="line">D  #PCFNM                 1     15                                </span><br><span class="line"> * 媒體檔名 (20)                                                  </span><br><span class="line">D  #FILNM                16     35                                </span><br><span class="line"> * 檔案筆數 (9)                                                   </span><br><span class="line">D  #TRCNT                36     44  0                             </span><br><span class="line"> * 來源主機 (10)                                                  </span><br><span class="line">D  #SYSNM                45     54                                </span><br><span class="line"> * 環境類別 (1)                                                      </span><br><span class="line">D  #ENVIR                55     55                                   </span><br><span class="line"> * ＭＢＲ名稱  (7)                                                   </span><br><span class="line">D  #MBR                  56     62                                   </span><br><span class="line"> * 回傳碼   (1)                                                      </span><br><span class="line">D  #RTNCD                63     63                                   </span><br><span class="line">D* &#x27;S&#x27;= 疑似外流冒用卡號資料檔傳送已完成                             </span><br><span class="line">I* 更改欄位名稱 =================================================*   </span><br><span class="line">IWFTR1R                                                              </span><br><span class="line">I              RTXT                        RTXT1                     </span><br><span class="line">IWFTR2R                                                              </span><br><span class="line">I              RTXT                        RTXT2                     </span><br><span class="line">IWFTR3R                                                              </span><br><span class="line">I              RTXT                        RTXT3                     </span><br><span class="line">IWFTR4R                                                              </span><br><span class="line">I              RTXT                        RTXT4                     </span><br><span class="line">IWFTR5R                                                              </span><br><span class="line">I              RTXT                        RTXT5                  </span><br><span class="line">IWFTR6R                                                           </span><br><span class="line">I              RTXT                        RTXT6                  </span><br><span class="line">IWFTR7R                                                           </span><br><span class="line">I              RTXT                        RTXT7                  </span><br><span class="line">IWFTR8R                                                           </span><br><span class="line">I              RTXT                        RTXT8                  </span><br><span class="line">ITFTBR                                                            </span><br><span class="line">I              USID                        TUSID                  </span><br><span class="line">C*===============================================================*</span><br><span class="line">C     *ENTRY        PLIST                                         </span><br><span class="line">C                   PARM                    #PACK                 </span><br><span class="line">C                   PARM                    #C912V                </span><br><span class="line">C*===============================================================*</span><br></pre></td></tr></table></figure>

<h2 id="主程序"><a href="#主程序" class="headerlink" title="主程序"></a>主程序</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">C*===============================================================*</span><br><span class="line">C*                  M A I N       R O U T I N E                  *</span><br><span class="line">C*===============================================================*</span><br><span class="line">C     BEGIN         TAG                                           </span><br><span class="line"> * 以接收檔名決定ＰＲＯＣ                                      </span><br><span class="line">C                   SELECT                                     </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR&#x27;                </span><br><span class="line">C                   EXSR      $PROC                            </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR1&#x27;               </span><br><span class="line">C                   EXSR      $PROC1                           </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR2&#x27;               </span><br><span class="line">C                   EXSR      $PROC2                           </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR3&#x27;               </span><br><span class="line">C                   EXSR      $PROC3                           </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR4&#x27;               </span><br><span class="line">C                   EXSR      $PROC4                           </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR5&#x27;               </span><br><span class="line">C                   EXSR      $PROC5                           </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR6&#x27;               </span><br><span class="line">C                   EXSR      $PROC6                           </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR7&#x27;               </span><br><span class="line">C                   EXSR      $PROC7                                </span><br><span class="line">C                   WHEN      #RFILE = &#x27;CPWFTR8&#x27;                    </span><br><span class="line">C                   EXSR      $PROC8                                </span><br><span class="line">C                   OTHER                                           </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;N&#x27;                         </span><br><span class="line">C                   GOTO      @EOJ                                  </span><br><span class="line">C                   ENDSL                                           </span><br><span class="line"> * 更新上傳通知                                                     </span><br><span class="line">C                   EXSR      $UFTBU                                </span><br><span class="line"> * 下傳通知                                                         </span><br><span class="line">C                   EXSR      $GTBSQ                                </span><br><span class="line">C                   EXSR      $SEND                                 </span><br><span class="line">C                   EXSR      $UPFTB                                </span><br><span class="line"> *                                                                  </span><br><span class="line">C     @EOJ          TAG                                             </span><br><span class="line">C                   SETON                                        LR </span><br><span class="line"> *===============================================================*  </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type1"><a href="#副程序，主流程-type1" class="headerlink" title="副程序，主流程(type1)"></a>副程序，主流程(type1)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">C*===============================================================*</span><br><span class="line"> *SR-$PROC          MAIN PROCUDURE                               *      </span><br><span class="line"> * 讀取接收檔 CPWFTR(LEN=150) 寫傳輸檔 CPWFTS1(LEN=300)          *      </span><br><span class="line"> *===============================================================*      </span><br><span class="line">CSR   $PROC         BEGSR                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS1&#x27;                        </span><br><span class="line"> * 打開檔案 CPWFTR &amp; CPWFTS1                                            </span><br><span class="line">C                   OPEN      CPWFTR                                    </span><br><span class="line">C                   OPEN      CPWFTS1                                   </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   IF        RCDNO0 &gt; 0                                </span><br><span class="line"> * 讀取接收檔                                                           </span><br><span class="line">C     1             SETLL     WFTRR                                     </span><br><span class="line">C                   READ      WFTRR                                  90 </span><br><span class="line">C                   DOW       *IN90  = *OFF                             </span><br><span class="line">C                   EVAL      #RTEXT = RTXT                             </span><br><span class="line"> * 取得客戶 CANO                                                        </span><br><span class="line">C                   EXSR      $GETCN                                    </span><br><span class="line"> * 寫入下載檔 1                                                         </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK      </span><br><span class="line">C                   EVAL      STXT1   = #STEXT                          </span><br><span class="line">C                   WRITE     WFTS1R                                    </span><br><span class="line"> *CPTFTB 下載資料筆數                                                   </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTRR                                  90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                           </span><br><span class="line">C                   IF        #TRCNT  = 0                               </span><br><span class="line">C                   EVAL      STXT1   = *BLANK                          </span><br><span class="line">C                   WRITE     WFTS1R                                    </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 關閉檔案                                                        </span><br><span class="line">C                   CLOSE     CPWFTR                               </span><br><span class="line">C                   CLOSE     CPWFTS1                              </span><br><span class="line"> *                                                                 </span><br><span class="line">CSR                 ENDSR                                          </span><br><span class="line"> *===============================================================* </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type2"><a href="#副程序，主流程-type2" class="headerlink" title="副程序，主流程(type2)"></a>副程序，主流程(type2)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$PROC1         MAIN PROCUDURE 1                             * </span><br><span class="line"> * 讀取接收檔 CPWFTR1(LEN=300) 寫傳輸檔 CPWFTS2(LEN=500)         * </span><br><span class="line"> *===============================================================* </span><br><span class="line">CSR   $PROC1        BEGSR                                          </span><br><span class="line"> *                                                                 </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS2&#x27;                   </span><br><span class="line"> * 打開檔案 CPWFTR1 &amp; CPWFTS2                                      </span><br><span class="line">C                   OPEN      CPWFTR1                              </span><br><span class="line">C                   OPEN      CPWFTS2                              </span><br><span class="line"> *                                                                 </span><br><span class="line">C                   IF        RCDNO1 &gt; 0                           </span><br><span class="line"> * 讀取接收檔 1                                                         </span><br><span class="line">C     1             SETLL     WFTR1R                                    </span><br><span class="line">C                   READ      WFTR1R                                 90 </span><br><span class="line">C                   DOW       *IN90  = *OFF                             </span><br><span class="line">C                   EVAL      #RTEXT = RTXT1                            </span><br><span class="line"> * 取得客戶 CANO                                                        </span><br><span class="line">C                   EXSR      $GETCN                                    </span><br><span class="line"> * 寫入下載檔 2                                                         </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK      </span><br><span class="line">C                   EVAL      STXT2   = #STEXT                          </span><br><span class="line">C                   WRITE     WFTS2R                                    </span><br><span class="line"> *CPTFTB 下載資料筆數                                                   </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTR1R                                 90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                             </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                         </span><br><span class="line">C                   IF        #TRCNT  = 0                             </span><br><span class="line">C                   EVAL      STXT2   = *BLANK                        </span><br><span class="line">C                   WRITE     WFTS2R                                  </span><br><span class="line">C                   IF        #RTNCD  = &#x27;P&#x27;                           </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;W&#x27;                           </span><br><span class="line">C                   ELSE                                              </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;E&#x27;                           </span><br><span class="line">C                   ENDIF                                             </span><br><span class="line">C                   ENDIF                                             </span><br><span class="line"> * 關閉檔案                                                           </span><br><span class="line">C                   CLOSE     CPWFTR1                                 </span><br><span class="line">C                   CLOSE     CPWFTS2                                 </span><br><span class="line"> *                                                                    </span><br><span class="line">CSR                 ENDSR                                             </span><br><span class="line"> *===============================================================*  </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type3"><a href="#副程序，主流程-type3" class="headerlink" title="副程序，主流程(type3)"></a>副程序，主流程(type3)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$PROC2         MAIN PROCUDURE 2                             *      </span><br><span class="line"> * 讀取接收檔 CPWFTR2(LEN=500) 寫傳輸檔 CPWFTS3(LEN=700)         *      </span><br><span class="line"> *===============================================================*      </span><br><span class="line">CSR   $PROC2        BEGSR                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS3&#x27;                        </span><br><span class="line"> * 打開檔案 CPWFTR2 &amp; CPWFTS3                                           </span><br><span class="line">C                   OPEN      CPWFTR2                                   </span><br><span class="line">C                   OPEN      CPWFTS3                                   </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   IF        RCDNO2 &gt; 0                                </span><br><span class="line"> * 讀取接收檔 2                                                         </span><br><span class="line">C     1             SETLL     WFTR2R                                    </span><br><span class="line">C                   READ      WFTR2R                                 90 </span><br><span class="line">C                   DOW       *IN90  = *OFF                             </span><br><span class="line">C                   EVAL      #RTEXT = RTXT2                            </span><br><span class="line"> * 取得客戶 CANO                                                        </span><br><span class="line">C                   EXSR      $GETCN                                    </span><br><span class="line"> * 寫入下載檔 3                                                         </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK      </span><br><span class="line">C                   EVAL      STXT3   = #STEXT                          </span><br><span class="line">C                   WRITE     WFTS3R                                    </span><br><span class="line"> *CPTFTB 下載資料筆數                                                   </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTR2R                                 90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                           </span><br><span class="line">C                   IF        #TRCNT  = 0                               </span><br><span class="line">C                   EVAL      STXT3   = *BLANK                          </span><br><span class="line">C                   WRITE     WFTS3R                                    </span><br><span class="line">C                   IF        #RTNCD  = &#x27;P&#x27;                             </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;W&#x27;                         </span><br><span class="line">C                   ELSE                                            </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;E&#x27;                         </span><br><span class="line">C                   ENDIF                                           </span><br><span class="line">C                   ENDIF                                           </span><br><span class="line"> * 關閉檔案                                                         </span><br><span class="line">C                   CLOSE     CPWFTR2                               </span><br><span class="line">C                   CLOSE     CPWFTS3                               </span><br><span class="line"> *                                                                  </span><br><span class="line">CSR                 ENDSR                                           </span><br><span class="line"> *===============================================================*  </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type4"><a href="#副程序，主流程-type4" class="headerlink" title="副程序，主流程(type4)"></a>副程序，主流程(type4)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$PROC3         MAIN PROCUDURE 3                             *  </span><br><span class="line"> * 讀取接收檔 CPWFTR3(LEN=700) 寫傳輸檔 CPWFTS4(LEN=900)         *  </span><br><span class="line"> *===============================================================*  </span><br><span class="line">CSR   $PROC3        BEGSR                                           </span><br><span class="line"> *                                                                  </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS4&#x27;                    </span><br><span class="line"> * 打開檔案 CPWFTR3 &amp; CPWFTS4                                          </span><br><span class="line">C                   OPEN      CPWFTR3                                  </span><br><span class="line">C                   OPEN      CPWFTS4                                  </span><br><span class="line"> *                                                                     </span><br><span class="line">C                   IF        RCDNO3 &gt; 0                               </span><br><span class="line"> * 讀取接收檔 3                                                        </span><br><span class="line">C     1             SETLL     WFTR3R                                   </span><br><span class="line">C                   READ      WFTR3R                                 90</span><br><span class="line">C                   DOW       *IN90  = *OFF                            </span><br><span class="line">C                   EVAL      #RTEXT = RTXT3                           </span><br><span class="line"> * 取得客戶 CANO                                                       </span><br><span class="line">C                   EXSR      $GETCN                                   </span><br><span class="line"> * 寫入下載檔 4                                                        </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK     </span><br><span class="line">C                   EVAL      STXT4   = #STEXT                         </span><br><span class="line">C                   WRITE     WFTS4R                                   </span><br><span class="line"> *CPTFTB 下載資料筆數                                                  </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTR3R                                 90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                           </span><br><span class="line">C                   IF        #TRCNT  = 0                               </span><br><span class="line">C                   EVAL      STXT4   = *BLANK                          </span><br><span class="line">C                   WRITE     WFTS4R                                    </span><br><span class="line">C                   IF        #RTNCD  = &#x27;P&#x27;                             </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;W&#x27;                             </span><br><span class="line">C                   ELSE                                                </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;E&#x27;                             </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 關閉檔案                                                             </span><br><span class="line">C                   CLOSE     CPWFTR3                               </span><br><span class="line">C                   CLOSE     CPWFTS4                               </span><br><span class="line"> *                                                                  </span><br><span class="line">CSR                 ENDSR                                           </span><br><span class="line"> *===============================================================* </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type5"><a href="#副程序，主流程-type5" class="headerlink" title="副程序，主流程(type5)"></a>副程序，主流程(type5)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$PROC4         MAIN PROCUDURE 4                             *  </span><br><span class="line"> * 讀取接收檔 CPWFTR4(LEN=900) 寫傳輸檔 CPWFTS5(LEN=1024)        *  </span><br><span class="line"> *===============================================================*  </span><br><span class="line">CSR   $PROC4        BEGSR                                           </span><br><span class="line"> *                                                                  </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS5&#x27;                    </span><br><span class="line"> * 打開檔案 CPWFTR4 &amp; CPWFTS5                                       </span><br><span class="line">C                   OPEN      CPWFTR4                               </span><br><span class="line">C                   OPEN      CPWFTS5                               </span><br><span class="line"> *                                                                  </span><br><span class="line">C                   IF        RCDNO4 &gt; 0                            </span><br><span class="line"> * 讀取接收檔 4                                                     </span><br><span class="line">C     1             SETLL     WFTR4R                                    </span><br><span class="line">C                   READ      WFTR4R                                 90 </span><br><span class="line">C                   DOW       *IN90  = *OFF                             </span><br><span class="line">C                   EVAL      #RTEXT = RTXT4                            </span><br><span class="line"> * 取得客戶 CANO                                                        </span><br><span class="line">C                   EXSR      $GETCN                                    </span><br><span class="line"> * 寫入下載檔 5                                                         </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK      </span><br><span class="line">C                   EVAL      STXT5   = #STEXT                          </span><br><span class="line">C                   WRITE     WFTS5R                                    </span><br><span class="line"> *CPTFTB 下載資料筆數                                                   </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTR4R                                 90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                      </span><br><span class="line">C                   IF        #TRCNT  = 0                          </span><br><span class="line">C                   EVAL      STXT5   = *BLANK                     </span><br><span class="line">C                   WRITE     WFTS5R                               </span><br><span class="line">C                   IF        #RTNCD  = &#x27;P&#x27;                        </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;W&#x27;                        </span><br><span class="line">C                   ELSE                                           </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;E&#x27;                        </span><br><span class="line">C                   ENDIF                                          </span><br><span class="line">C                   ENDIF                                          </span><br><span class="line"> * 關閉檔案                                                        </span><br><span class="line">C                   CLOSE     CPWFTR4                              </span><br><span class="line">C                   CLOSE     CPWFTS5                              </span><br><span class="line"> *                                                                 </span><br><span class="line">CSR                 ENDSR                                          </span><br><span class="line"> *===============================================================* </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type6"><a href="#副程序，主流程-type6" class="headerlink" title="副程序，主流程(type6)"></a>副程序，主流程(type6)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$PROC5         MAIN PROCUDURE 5                             * </span><br><span class="line"> * 讀取接收檔 CPWFTR5(LEN=1024) 寫傳輸檔 CPWFTS6(LEN=1300)       *      </span><br><span class="line"> *===============================================================*      </span><br><span class="line">CSR   $PROC5        BEGSR                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS6&#x27;                        </span><br><span class="line"> * 打開檔案 CPWFTR5 &amp; CPWFTS6                                           </span><br><span class="line">C                   OPEN      CPWFTR5                                   </span><br><span class="line">C                   OPEN      CPWFTS6                                   </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   IF        RCDNO5 &gt; 0                                </span><br><span class="line"> * 讀取接收檔 5                                                         </span><br><span class="line">C     1             SETLL     WFTR5R                                    </span><br><span class="line">C                   READ      WFTR5R                                 90 </span><br><span class="line">C                   DOW       *IN90  = *OFF                             </span><br><span class="line">C                   EVAL      #RTEXT = RTXT5                            </span><br><span class="line"> * 取得客戶 CANO                                                        </span><br><span class="line">C                   EXSR      $GETCN                                    </span><br><span class="line"> * 寫入下載檔 6                                                         </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK      </span><br><span class="line">C                   EVAL      STXT6   = #STEXT                          </span><br><span class="line">C                   WRITE     WFTS6R                                    </span><br><span class="line"> *CPTFTB 下載資料筆數                                                   </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTR5R                                 90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                           </span><br><span class="line">C                   IF        #TRCNT  = 0                               </span><br><span class="line">C                   EVAL      STXT6   = *BLANK                          </span><br><span class="line">C                   WRITE     WFTS6R                                    </span><br><span class="line">C                   IF        #RTNCD  = &#x27;P&#x27;                             </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;W&#x27;                             </span><br><span class="line">C                   ELSE                                            </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;E&#x27;                         </span><br><span class="line">C                   ENDIF                                           </span><br><span class="line">C                   ENDIF                                           </span><br><span class="line"> * 關閉檔案                                                         </span><br><span class="line">C                   CLOSE     CPWFTR5                               </span><br><span class="line">C                   CLOSE     CPWFTS6                               </span><br><span class="line"> *                                                                  </span><br><span class="line">CSR                 ENDSR                                           </span><br><span class="line"> *===============================================================*  </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type7"><a href="#副程序，主流程-type7" class="headerlink" title="副程序，主流程(type7)"></a>副程序，主流程(type7)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$PROC6         MAIN PROCUDURE 6                             *  </span><br><span class="line"> * 讀取接收檔 CPWFTR6(LEN=1300) 寫傳輸檔 CPWFTS7(LEN=2048)       *  </span><br><span class="line"> *===============================================================*  </span><br><span class="line">CSR   $PROC6        BEGSR                                           </span><br><span class="line"> *                                                                  </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS7&#x27;                    </span><br><span class="line"> * 打開檔案 CPWFTR6 &amp; CPWFTS7                                       </span><br><span class="line">C                   OPEN      CPWFTR6                                   </span><br><span class="line">C                   OPEN      CPWFTS7                                   </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   IF        RCDNO6 &gt; 0                                </span><br><span class="line"> * 讀取接收檔 6                                                         </span><br><span class="line">C     1             SETLL     WFTR6R                                    </span><br><span class="line">C                   READ      WFTR6R                                 90 </span><br><span class="line">C                   DOW       *IN90  = *OFF                             </span><br><span class="line">C                   EVAL      #RTEXT = RTXT6                            </span><br><span class="line"> * 取得客戶 CANO                                                        </span><br><span class="line">C                   EXSR      $GETCN                                    </span><br><span class="line"> * 寫入下載檔 7                                                         </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK      </span><br><span class="line">C                   EVAL      STXT7   = #STEXT                          </span><br><span class="line">C                   WRITE     WFTS7R                                    </span><br><span class="line"> *CPTFTB 下載資料筆數                                                   </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTR6R                                 90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                           </span><br><span class="line">C                   IF        #TRCNT  = 0                               </span><br><span class="line">C                   EVAL      STXT7   = *BLANK                          </span><br><span class="line">C                   WRITE     WFTS7R                                    </span><br><span class="line">C                   IF        #RTNCD  = &#x27;P&#x27;                             </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;W&#x27;                             </span><br><span class="line">C                   ELSE                                                </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;E&#x27;                             </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 關閉檔案                                                             </span><br><span class="line">C                   CLOSE     CPWFTR6                                  </span><br><span class="line">C                   CLOSE     CPWFTS7                                  </span><br><span class="line"> *                                                                     </span><br><span class="line">CSR                 ENDSR                                              </span><br><span class="line"> *===============================================================*  </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type8"><a href="#副程序，主流程-type8" class="headerlink" title="副程序，主流程(type8)"></a>副程序，主流程(type8)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$PROC7         MAIN PROCUDURE 7                             *     </span><br><span class="line"> * 讀取接收檔 CPWFTR7(LEN=2048) 寫傳輸檔 CPWFTS8(LEN=4090)       *     </span><br><span class="line"> *===============================================================*     </span><br><span class="line">CSR   $PROC7        BEGSR                                              </span><br><span class="line"> *                                                                     </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS8&#x27;                       </span><br><span class="line"> * 打開檔案 CPWFTR7 &amp; CPWFTS8                                          </span><br><span class="line">C                   OPEN      CPWFTR7                                  </span><br><span class="line">C                   OPEN      CPWFTS8                                  </span><br><span class="line"> *                                                                     </span><br><span class="line">C                   IF        RCDNO7 &gt; 0                               </span><br><span class="line"> * 讀取接收檔 7                                                        </span><br><span class="line">C     1             SETLL     WFTR7R                                   </span><br><span class="line">C                   READ      WFTR7R                                 90 </span><br><span class="line">C                   DOW       *IN90  = *OFF                             </span><br><span class="line">C                   EVAL      #RTEXT = RTXT7                            </span><br><span class="line"> * 取得客戶 CANO                                                        </span><br><span class="line">C                   EXSR      $GETCN                                    </span><br><span class="line"> * 寫入下載檔 8                                                         </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK      </span><br><span class="line">C                   EVAL      STXT8   = #STEXT                          </span><br><span class="line">C                   WRITE     WFTS8R                                    </span><br><span class="line"> *CPTFTB 下載資料筆數                                                   </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTR7R                                 90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                           </span><br><span class="line">C                   IF        #TRCNT  = 0                          </span><br><span class="line">C                   EVAL      STXT8   = *BLANK                     </span><br><span class="line">C                   WRITE     WFTS8R                               </span><br><span class="line">C                   IF        #RTNCD  = &#x27;P&#x27;                        </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;W&#x27;                        </span><br><span class="line">C                   ELSE                                           </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;E&#x27;                        </span><br><span class="line">C                   ENDIF                                          </span><br><span class="line">C                   ENDIF                                          </span><br><span class="line"> * 關閉檔案                                                        </span><br><span class="line">C                   CLOSE     CPWFTR7                              </span><br><span class="line">C                   CLOSE     CPWFTS8                              </span><br><span class="line"> *                                                                 </span><br><span class="line">CSR                 ENDSR                                          </span><br><span class="line"> *===============================================================* </span><br></pre></td></tr></table></figure>
<h2 id="副程序，主流程-type9"><a href="#副程序，主流程-type9" class="headerlink" title="副程序，主流程(type9)"></a>副程序，主流程(type9)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$PROC8         MAIN PROCUDURE 8                             * </span><br><span class="line"> * 讀取接收檔 CPWFTR8(LEN=4090) 寫傳輸檔 CPWFTS8(LEN=4090)       * </span><br><span class="line"> *===============================================================*     </span><br><span class="line">CSR   $PROC8        BEGSR                                              </span><br><span class="line"> *                                                                     </span><br><span class="line">C                   EVAL      #SFILE = &#x27;CPWFTS8&#x27;                       </span><br><span class="line"> * 打開檔案 CPWFTR8 &amp; CPWFTS8                                          </span><br><span class="line">C                   OPEN      CPWFTR8                                  </span><br><span class="line">C                   OPEN      CPWFTS8                                  </span><br><span class="line"> *                                                                     </span><br><span class="line">C                   IF        RCDNO8 &gt; 0                               </span><br><span class="line"> * 讀取接收檔 8                                                        </span><br><span class="line">C     1             SETLL     WFTR8R                                   </span><br><span class="line">C                   READ      WFTR8R                                 90</span><br><span class="line">C                   DOW       *IN90  = *OFF                            </span><br><span class="line">C                   EVAL      #RTEXT = RTXT8                           </span><br><span class="line"> * 取得客戶 CANO                                                       </span><br><span class="line">C                   EXSR      $GETCN                                   </span><br><span class="line"> * 寫入下載檔 8                                                        </span><br><span class="line">C                   IF        #CANOOF&lt;&gt; *BLANK OR #LKCNH &lt;&gt; *BLANK      </span><br><span class="line">C                   EVAL      STXT8   = #STEXT                          </span><br><span class="line">C                   WRITE     WFTS8R                                    </span><br><span class="line"> *CPTFTB 下載資料筆數                                                   </span><br><span class="line">C                   EVAL      #TRCNT += 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   READ      WFTR8R                                 90 </span><br><span class="line">C                   ENDDO                                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 避免空檔錯誤，寫入一筆空值                                           </span><br><span class="line">C                   IF        #TRCNT  = 0                               </span><br><span class="line">C                   EVAL      STXT8   = *BLANK                          </span><br><span class="line">C                   WRITE     WFTS8R                                    </span><br><span class="line">C                   IF        #RTNCD  = &#x27;P&#x27;                             </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;W&#x27;                             </span><br><span class="line">C                   ELSE                                                </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;E&#x27;                      </span><br><span class="line">C                   ENDIF                                        </span><br><span class="line">C                   ENDIF                                        </span><br><span class="line"> * 關閉檔案                                                      </span><br><span class="line">C                   CLOSE     CPWFTR8                            </span><br><span class="line">C                   CLOSE     CPWFTS8                            </span><br><span class="line"> *                                                               </span><br><span class="line">CSR                 ENDSR                                        </span><br><span class="line"> *===============================================================</span><br></pre></td></tr></table></figure>
<h2 id="副程序-get-cano"><a href="#副程序-get-cano" class="headerlink" title="副程序(get cano)"></a>副程序(get cano)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$GETCN       取得    ＣＡＮＯ　                             </span><br><span class="line"> *===============================================================</span><br><span class="line">CSR   $GETCN        BEGSR                                        </span><br><span class="line">C*                                                               </span><br><span class="line">C                   RESET                   #STEXT               </span><br><span class="line">C                   MOVEL     *BLANK        #CANOOF              </span><br><span class="line">C                   MOVEL     *BLANK        #LKCNH               </span><br><span class="line">C                   MOVEL     *BLANK        #LKCNO           19  </span><br><span class="line">C                   MOVEL     *BLANK        #LKCNO           19        </span><br><span class="line"> *                                                             </span><br><span class="line">C                   EVAL      #LKCNO     =  #RTEXT                     </span><br><span class="line"> *                                                    </span><br><span class="line">C     #LKCNO        CHAIN     CPMDM1                             91    </span><br><span class="line">C     *IN91         IFEQ      *OFF                                     </span><br><span class="line">C                   MOVEL     CANOOF        #CANOOF          32        </span><br><span class="line"> *                                                       </span><br><span class="line">C                   ELSE                                               </span><br><span class="line">C     #LKCNO        IFNE      *BLANKS                                  </span><br><span class="line">C                   Z-ADD     1             #HSMOD            1 0      </span><br><span class="line">C                   MOVEL     #LKCNO        #HSDTA         1024        </span><br><span class="line">C                   MOVEL     *BLANKS       #HSRSL         1024        </span><br><span class="line">C                   CALL      &#x27;CS0438R&#x27;                                </span><br><span class="line">C                   PARM                    #HSMOD                     </span><br><span class="line">C                   PARM                    #HSDTA                     </span><br><span class="line">C                   PARM                    #HSRSL                     </span><br><span class="line"> *                                                                  </span><br><span class="line">C                   MOVEL     #HSRSL        #LKCNH           32     </span><br><span class="line">C                   ENDIF                                           </span><br><span class="line">C                   ENDIF                                           </span><br><span class="line"> * 搬值                                                             </span><br><span class="line">C                   EVAL      #DTADT     =  #DATE8                  </span><br><span class="line">C                   EVAL      #X1        =  &#x27;,&#x27;                     </span><br><span class="line">C                   EVAL      #D1        =  &#x27;&quot;&#x27;                     </span><br><span class="line">C                   EVAL      #CANOF     =  #CANOOF                 </span><br><span class="line">C                   EVAL      #D2        =  &#x27;&quot;&#x27;                     </span><br><span class="line">C                   EVAL      #X2        =  &#x27;,&#x27;                     </span><br><span class="line">C                   EVAL      #D3        =  &#x27;&quot;&#x27;                     </span><br><span class="line">C                   EVAL      #CNOHS     =  #LKCNH                  </span><br><span class="line">C                   EVAL      #D4        =  &#x27;&quot;&#x27;                     </span><br><span class="line"> *                                                                  </span><br><span class="line">CSR                 ENDSR                                           </span><br><span class="line"> *===============================================================*  </span><br></pre></td></tr></table></figure>
<h2 id="副程序-傳輸-log"><a href="#副程序-傳輸-log" class="headerlink" title="副程序(傳輸 log)"></a>副程序(傳輸 log)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *$UFTBU           UPDATE CPTFTB -UPLOAD * 更新 CPTFTB 上傳記錄  *  </span><br><span class="line"> *===============================================================*  </span><br><span class="line">CSR   $UFTBU        BEGSR                                           </span><br><span class="line"> * 更新 CPTFTB 狀態                                                 </span><br><span class="line"> * 讀批次檔案傳輸控制檔 CPTFTB (KEY=FILTP+MOCNO+BATNO+BATSQ)        </span><br><span class="line">C     #KFTBU        CHAIN     TFTBR                              92 </span><br><span class="line">C                   IF        *IN92   = *OFF                        </span><br><span class="line">C                   EVAL      PRCCD   = &#x27;00&#x27;                        </span><br><span class="line">C                   EVAL      STCNT   = #TRCNT                      </span><br><span class="line"> *                                                                  </span><br><span class="line">C                   EVAL      WSID    = #WSID                       </span><br><span class="line">C                   EVAL      TUSID   = USRID1                      </span><br><span class="line">C                   EVAL      CHGCD   = &#x27;U&#x27;                         </span><br><span class="line">C                   TIME                    #TIM14                  </span><br><span class="line">C                   EVAL      SYSD8   = #DATE8                      </span><br><span class="line">C                   EVAL      SYSTM   = #TIME6                      </span><br><span class="line">C                   UPDATE    TFTBR                                 </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">CSR                 ENDSR                                               </span><br><span class="line"> *===============================================================*  </span><br></pre></td></tr></table></figure>
<h2 id="副程序-get-transfer-seq"><a href="#副程序-get-transfer-seq" class="headerlink" title="副程序(get transfer seq)"></a>副程序(get transfer seq)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-$GTBSQ    GET BATSQ AND WRITE CTPTBG  * 下載寫入 CPTFTB *          </span><br><span class="line"> *===============================================================*      </span><br><span class="line">CSR   $GTBSQ        BEGSR                                               </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   EVAL      #BATSQ  = 99                              </span><br><span class="line"> * 決定序號                                                             </span><br><span class="line"> * 讀批次檔案傳輸控制檔 CPTFTB (KEY=FILTP+MOCNO+BATNO+BATSQ)            </span><br><span class="line">C     #KFTB         SETGT     TFTBR                                     </span><br><span class="line">C                   READP     TFTBR                                  91 </span><br><span class="line">C                   IF        *IN91   = *OFF   AND  #FILTP  = FILTP  AN </span><br><span class="line">C                             #MOCNO  = MOCNO  AND  #DATE    = BATNO    </span><br><span class="line">C                   EVAL      #BATSQ  = BATSQ + 1                       </span><br><span class="line">C                   ELSE                                                </span><br><span class="line">C                   EVAL      #BATSQ  = 1                               </span><br><span class="line">C                   ENDIF                                               </span><br><span class="line"> * 寫入 CPTFTB                                                          </span><br><span class="line">C                   CLEAR                   TFTBR                       </span><br><span class="line">C                   EVAL      FILTP   = #FILTP                          </span><br><span class="line">C                   EVAL      MOCNO   = #MOCNO                          </span><br><span class="line">C                   EVAL      BATNO   = #DATE                           </span><br><span class="line">C                   EVAL      BATSQ   = #BATSQ                          </span><br><span class="line"> *                                                                      </span><br><span class="line">C                   EVAL      WSID    = #WSID                           </span><br><span class="line">C                   EVAL      TUSID   = USRID1                          </span><br><span class="line">C                   EVAL      CHGCD   = &#x27;A&#x27;                             </span><br><span class="line">C                   TIME                    #TIM14                      </span><br><span class="line">C                   EVAL      SYSD8   = #DATE8                          </span><br><span class="line">C                   EVAL      SYSTM   = #TIME6                          </span><br><span class="line">C                   WRITE     TFTBR                                91   </span><br><span class="line">C                   DOW       *IN91   = *ON                             </span><br><span class="line">C                   EVAL      #BATSQ  = #BATSQ + 1                     </span><br><span class="line">C                   EVAL      BATSQ   = #BATSQ                         </span><br><span class="line">C                   WRITE     TFTBR                                91  </span><br><span class="line">C                   ENDDO                                              </span><br><span class="line"> *                                                                     </span><br><span class="line">CSR                 ENDSR                                              </span><br><span class="line"> *===============================================================*   </span><br></pre></td></tr></table></figure>
<h2 id="副程序-send-msg-dataQ"><a href="#副程序-send-msg-dataQ" class="headerlink" title="副程序(send msg dataQ)"></a>副程序(send msg dataQ)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *$SEND     SEND DATAQ TO FTPBKS00A QUEUE     * 丟訊息至 DATAQ* *      </span><br><span class="line"> *===============================================================*     </span><br><span class="line">CSR   $SEND         BEGSR                                              </span><br><span class="line"> *                                                                     </span><br><span class="line">C                   EVAL      #DQNAM  = #SDQN2                         </span><br><span class="line">C                   EVAL      #DQLIB  = #LIB                           </span><br><span class="line">C                   Z-ADD     1024          #DQLEN                     </span><br><span class="line">C                   EVAL      @NPCOD  = &#x27;91&#x27;                           </span><br><span class="line">C                   EVAL      @FILNM  = #SFILE                         </span><br><span class="line">C                   EVAL      @MBRNM  = #MBR                           </span><br><span class="line">C                   EVAL      @HOSTO  = &#x27;INDM&#x27;                    </span><br><span class="line"> *4+1+ 日期 + 序號                                                </span><br><span class="line">C                   EVAL      @MOCNO  = #MOCNO                    </span><br><span class="line">C                   EVAL      @FILTP  = #FILTP                    </span><br><span class="line">C                   EVAL      @DATE   = #DATE                     </span><br><span class="line">C                   EVAL      @SEQ    = #BATSQ                    </span><br><span class="line">C                   EVAL      @SNDTP  = &#x27;O&#x27;                       </span><br><span class="line">C                   EVAL      @SNDTX  = &#x27;.TXT&#x27;                    </span><br><span class="line"> * 檔名回傳給 CLP                                                 </span><br><span class="line">C                   EVAL      #FILNM  = @FILTX                    </span><br><span class="line"> *  PC 檔名回傳給 CLP                                             </span><br><span class="line">C                   EVAL      #PCFNM  = @PCFNM                    </span><br><span class="line"> *                                                                </span><br><span class="line">C                   EVAL      @DEF1   = &#x27;5&#x27;                       </span><br><span class="line">C                   EVAL      @DEF3   = &#x27;1&#x27;                       </span><br><span class="line">C                   EVAL      @DEF11  = &#x27;N&#x27;                       </span><br><span class="line">C                   EVAL      @DEF12  = *BLANK                    </span><br><span class="line"> * 寫入 DATAQ                                                         </span><br><span class="line">C                   CALL      &#x27;QSNDDTAQ&#x27;                              </span><br><span class="line">C                   PARM                    #DQNAM                    </span><br><span class="line">C                   PARM                    #DQLIB                    </span><br><span class="line">C                   PARM                    #DQLEN                    </span><br><span class="line">C                   PARM                    #PSND2                    </span><br><span class="line"> *                                                                    </span><br><span class="line">CSR                 ENDSR                                             </span><br><span class="line"> *===============================================================*   </span><br></pre></td></tr></table></figure>
<h2 id="副程序-upload-傳輸-log"><a href="#副程序-upload-傳輸-log" class="headerlink" title="副程序(upload 傳輸 log)"></a>副程序(upload 傳輸 log)</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *$UPFTB      UPDATE CPTFTB - DOWNLOAD   * 更新 CPTFTB 下載記錄  *    </span><br><span class="line"> *===============================================================*    </span><br><span class="line">CSR   $UPFTB        BEGSR                                             </span><br><span class="line"> * 更新 CPTFTB 狀態                                                   </span><br><span class="line"> * 讀批次檔案傳輸控制檔 CPTFTB (KEY=FILTP+MOCNO+BATNO+BATSQ)          </span><br><span class="line">C     #KFTB         CHAIN     TFTBR                              92   </span><br><span class="line">C                   IF        *IN92   = *OFF                          </span><br><span class="line">C                   EVAL      TCNT    = #TRCNT                        </span><br><span class="line">C                   EVAL      TAMT    = 0                    </span><br><span class="line">C                   EVAL      STCNT   = 0                    </span><br><span class="line">C                   EVAL      STAMT   = 0                    </span><br><span class="line">C                   TIME                    #TIM14           </span><br><span class="line">C                   EVAL      FILDT   = #DATE8               </span><br><span class="line">C                   EVAL      FILTM   = #TIME6               </span><br><span class="line">C                   EVAL      PRCCD   = &#x27;00&#x27;                 </span><br><span class="line">C                   EVAL      AS4LN   = @LIB                 </span><br><span class="line">C                   EVAL      AS4FN   = #SFILE               </span><br><span class="line">C                   EVAL      AS4MN   = #MBR                 </span><br><span class="line">C                   EVAL      FTDT1   = 0                    </span><br><span class="line"> *                                                           </span><br><span class="line">C                   EVAL      FTTX1   = #FILNM               </span><br><span class="line"> *                                                           </span><br><span class="line">C                   EVAL      WSID    = #WSID                </span><br><span class="line">C                   EVAL      TUSID   = USRID1               </span><br><span class="line">C                   EVAL      CHGCD   = &#x27;U&#x27;                  </span><br><span class="line">C                   TIME                    #TIM14                   </span><br><span class="line">C                   EVAL      SYSD8   = #DATE8                       </span><br><span class="line">C                   EVAL      SYSTM   = #TIME6                       </span><br><span class="line">C                   UPDATE    TFTBR                                  </span><br><span class="line">C                   ENDIF                                            </span><br><span class="line"> *                                                                   </span><br><span class="line">CSR                 ENDSR                                            </span><br><span class="line"> *===============================================================* </span><br></pre></td></tr></table></figure>
<h2 id="初始副程序"><a href="#初始副程序" class="headerlink" title="初始副程序"></a>初始副程序</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> *===============================================================* </span><br><span class="line"> *SR-*INZSR        INITIAL WORK FIELD VALUE (AUTO)               *   </span><br><span class="line"> *===============================================================*   </span><br><span class="line">CSR   *INZSR        BEGSR                                            </span><br><span class="line"> * ＮＦＳ預設值                                                      </span><br><span class="line">C                   EVAL      #PSND2  = *BLANK                       </span><br><span class="line">C                   EVAL      @HOSFR  = #SYSNM                       </span><br><span class="line">C                   EVAL      #FILTP  = &#x27;4&#x27;                          </span><br><span class="line">C                   EVAL      #MOCNO  = &#x27;RISK&#x27;                       </span><br><span class="line">C                   EVAL      #DATE   = *DATE                        </span><br><span class="line">C                   EVAL      @MCHNO  = *BLANK                  </span><br><span class="line"> * 決定ＬＩＢ                                                   </span><br><span class="line">C                   IF        #ENVIR  = &#x27;T&#x27;                     </span><br><span class="line">C                   EVAL      @LIB    = &#x27;DMLIBT&#x27;                </span><br><span class="line">C                   EVAL      #LIB    = &#x27;*LIBL&#x27;                 </span><br><span class="line">C                   ELSE                                        </span><br><span class="line">C                   EVAL      @LIB    = &#x27;DMLIB&#x27;                 </span><br><span class="line">C                   EVAL      #LIB    = &#x27;DMLIB&#x27;                 </span><br><span class="line">C                   ENDIF                                       </span><br><span class="line"> * 寫入初值                                                     </span><br><span class="line">C                   EVAL      #TRCNT  = 0                       </span><br><span class="line">C                   EVAL      #RTNCD  = &#x27;S&#x27;                     </span><br><span class="line">C                   EVAL      #DATE7  = *DATE -19110000         </span><br><span class="line">C                   TIME                    #TIM14              </span><br><span class="line">C                   EVAL      #TIME   = #TIME6                  </span><br><span class="line"> * CPTFTB-UPLOAD 的鍵值 ( KEY=FILTP+MOCNO+BATNO+BATSQ )         </span><br><span class="line">C     #KFTBU        KLIST                                       </span><br><span class="line">C                   KFLD                    #RFILTP                  </span><br><span class="line">C                   KFLD                    #RMOCNO                  </span><br><span class="line">C                   KFLD                    #RBATNO                  </span><br><span class="line">C                   KFLD                    #RBATSQ                  </span><br><span class="line"> *                                                                   </span><br><span class="line"> * CPTFTB-DOWNLOAD 的鍵值 ( KEY=FILTP+MOCNO+BATNO+BATSQ )            </span><br><span class="line">C     #KFTB         KLIST                                            </span><br><span class="line">C                   KFLD                    #FILTP                   </span><br><span class="line">C                   KFLD                    #MOCNO                   </span><br><span class="line">C                   KFLD                    #DATE                    </span><br><span class="line">C                   KFLD                    #BATSQ                   </span><br><span class="line"> *                                                                   </span><br><span class="line">CSR                 ENDSR                                            </span><br><span class="line"> *===============================================================*   </span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://kaidloglife.netlify.app">Cheng Kai(Nicholas) Cheng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://kaidloglife.netlify.app/2019/12/05/as400/">https://kaidloglife.netlify.app/2019/12/05/as400/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/as400/">as400</a></div><div class="post_share"><div class="social-share" data-image="https://www.itl.cat/pngfile/big/287-2878120_desktop-high-res-hd-wallpapers-38120428-desktop-wallpaper.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/17/unit_test_golang/"><img class="prev-cover" src="https://i.imgur.com/ean7S3b.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">How to do unit test for golang program?</div></div></a></div><div class="next-post pull-right"><a href="/2019/11/23/blog/"><img class="next-cover" src="https://mcdn.wallpapersafari.com/medium/74/64/OUSdJh.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">How to add your footprint in your blog?</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.imgur.com/MMQsfsJ.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Cheng Kai(Nicholas) Cheng</div><div class="author-info__description">In persuit of those I am favor of</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/kaidlog"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/kaidlog" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:kevinchengtn@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Next stop, california!!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B3%87%E6%96%99%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">資料格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.</span> <span class="toc-text">主程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type1"><span class="toc-number">3.</span> <span class="toc-text">副程序，主流程(type1)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type2"><span class="toc-number">4.</span> <span class="toc-text">副程序，主流程(type2)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type3"><span class="toc-number">5.</span> <span class="toc-text">副程序，主流程(type3)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type4"><span class="toc-number">6.</span> <span class="toc-text">副程序，主流程(type4)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type5"><span class="toc-number">7.</span> <span class="toc-text">副程序，主流程(type5)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type6"><span class="toc-number">8.</span> <span class="toc-text">副程序，主流程(type6)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type7"><span class="toc-number">9.</span> <span class="toc-text">副程序，主流程(type7)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type8"><span class="toc-number">10.</span> <span class="toc-text">副程序，主流程(type8)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%B8%BB%E6%B5%81%E7%A8%8B-type9"><span class="toc-number">11.</span> <span class="toc-text">副程序，主流程(type9)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F-get-cano"><span class="toc-number">12.</span> <span class="toc-text">副程序(get cano)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F-%E5%82%B3%E8%BC%B8-log"><span class="toc-number">13.</span> <span class="toc-text">副程序(傳輸 log)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F-get-transfer-seq"><span class="toc-number">14.</span> <span class="toc-text">副程序(get transfer seq)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F-send-msg-dataQ"><span class="toc-number">15.</span> <span class="toc-text">副程序(send msg dataQ)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E7%A8%8B%E5%BA%8F-upload-%E5%82%B3%E8%BC%B8-log"><span class="toc-number">16.</span> <span class="toc-text">副程序(upload 傳輸 log)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%89%AF%E7%A8%8B%E5%BA%8F"><span class="toc-number">17.</span> <span class="toc-text">初始副程序</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/19/gozero_structure/" title="What's the gozero structure?"><img src="https://i.imgur.com/ean7S3b.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="What's the gozero structure?"/></a><div class="content"><a class="title" href="/2022/05/19/gozero_structure/" title="What's the gozero structure?">What's the gozero structure?</a><time datetime="2022-05-18T18:07:38.287Z" title="Created 2022-05-19 02:07:38">2022-05-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/19/pack_unit_test/" title="How to pack a set of unit tests for golang program?"><img src="https://cdna.artstation.com/p/assets/images/images/047/086/458/large/ben-kleber-sin-titulo.jpg?1646734439" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="How to pack a set of unit tests for golang program?"/></a><div class="content"><a class="title" href="/2022/05/19/pack_unit_test/" title="How to pack a set of unit tests for golang program?">How to pack a set of unit tests for golang program?</a><time datetime="2022-05-18T16:59:50.015Z" title="Created 2022-05-19 00:59:50">2022-05-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/17/unit_test_golang/" title="How to do unit test for golang program?"><img src="https://i.imgur.com/ean7S3b.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="How to do unit test for golang program?"/></a><div class="content"><a class="title" href="/2022/05/17/unit_test_golang/" title="How to do unit test for golang program?">How to do unit test for golang program?</a><time datetime="2022-05-17T13:40:13.457Z" title="Created 2022-05-17 21:40:13">2022-05-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2019/12/05/as400/" title="How to use as400 to automize the data stream?"><img src="https://www.itl.cat/pngfile/big/287-2878120_desktop-high-res-hd-wallpapers-38120428-desktop-wallpaper.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="How to use as400 to automize the data stream?"/></a><div class="content"><a class="title" href="/2019/12/05/as400/" title="How to use as400 to automize the data stream?">How to use as400 to automize the data stream?</a><time datetime="2019-12-05T14:51:24.000Z" title="Created 2019-12-05 22:51:24">2019-12-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2019/11/23/blog/" title="How to add your footprint in your blog?"><img src="https://mcdn.wallpapersafari.com/medium/74/64/OUSdJh.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="How to add your footprint in your blog?"/></a><div class="content"><a class="title" href="/2019/11/23/blog/" title="How to add your footprint in your blog?">How to add your footprint in your blog?</a><time datetime="2019-11-23T11:57:15.000Z" title="Created 2019-11-23 19:57:15">2019-11-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By Cheng Kai(Nicholas) Cheng</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://kaidloglife.netlify.app/2019/12/05/as400/'
    this.page.identifier = '2019/12/05/as400/'
    this.page.title = 'How to use as400 to automize the data stream?'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://kaidloglife-netlify-app.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>